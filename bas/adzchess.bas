10 REM Simple Chess for Minimal BASIC (No GOSUB)
20 REM Board: B[0-63], Pieces: 0=empty, 1-6=W pieces, 11-16=B pieces
30 REM 1/11=Pawn, 2/12=Knight, 3/13=Bishop, 4/14=Rook, 5/15=Queen, 6/16=King
40 DIM B[64]
50 DIM M[400]
60 REM Setup board
70 B[0]=14
80 B[1]=12
90 B[2]=13
100 B[3]=15
110 B[4]=16
120 B[5]=13
130 B[6]=12
140 B[7]=14
150 I=8
160 B[I]=11
170 I=I+1
180 IF I<16 THEN 160
190 I=16
200 B[I]=0
210 I=I+1
220 IF I<48 THEN 200
230 I=48
240 B[I]=1
250 I=I+1
260 IF I<56 THEN 240
270 B[56]=4
280 B[57]=2
290 B[58]=3
300 B[59]=5
310 B[60]=6
320 B[61]=3
330 B[62]=2
340 B[63]=4
350 T=1
360 PRINT "BASIC Chess Engine"
370 PRINT " "
380 REM Display board
390 PRINT "  0 1 2 3 4 5 6 7"
400 R=0
410 PRINT R;": ";
420 C=0
430 SQ=R*8+C
440 P=B[SQ]
450 IF P=0 THEN 620
460 IF P=1 THEN PRINT "P ";
470 IF P=2 THEN PRINT "N ";
480 IF P=3 THEN PRINT "B ";
490 IF P=4 THEN PRINT "R ";
500 IF P=5 THEN PRINT "Q ";
510 IF P=6 THEN PRINT "K ";
520 IF P=11 THEN PRINT "p ";
530 IF P=12 THEN PRINT "n ";
540 IF P=13 THEN PRINT "b ";
550 IF P=14 THEN PRINT "r ";
560 IF P=15 THEN PRINT "q ";
570 IF P=16 THEN PRINT "k ";
580 C=C+1
590 IF C<8 THEN 430
600 PRINT " "
610 GOTO 630
620 PRINT ". ";
625 GOTO 580
630 R=R+1
640 IF R<8 THEN 410
650 PRINT " "
660 REM Game turn
670 IF T=1 THEN 710
680 PRINT "Black (Computer) move"
690 GOTO 1000
710 PRINT "White (Human) move"
720 PRINT "From square (0-63):"
730 INPUT F
740 PRINT "To square (0-63):"
750 INPUT D
760 P=B[F]
770 IF P=0 THEN 720
780 IF P>10 THEN 720
790 REM Make move
800 B[D]=P
810 B[F]=0
820 T=0
830 GOTO 380
1000 REM Computer finds move
1010 MC=0
1020 I=0
1030 P=B[I]
1040 IF P<11 THEN 1850
1050 IF P>16 THEN 1850
1060 REM Check piece type and generate moves
1070 IF P=11 THEN 1100
1075 IF P=12 THEN 1300
1077 IF P=13 THEN 1500
1078 IF P=14 THEN 1500
1079 IF P=15 THEN 1500
1080 IF P=16 THEN 1700
1085 GOTO 1850
1100 REM Black Pawn at I
1110 D=I+8
1120 IF D>63 THEN 1850
1130 IF B[D]=0 THEN 1260
1140 D=I+7
1150 IF D>63 THEN 1850
1160 IF B[D]=0 THEN 1850
1170 IF B[D]>10 THEN 1850
1180 M[MC]=I
1190 MC=MC+1
1200 M[MC]=D
1210 MC=MC+1
1220 GOTO 1850
1260 M[MC]=I
1270 MC=MC+1
1280 M[MC]=D
1290 MC=MC+1
1295 GOTO 1140
1300 REM Knight at I - try all 8 moves
1310 K=0
1320 D=I-17
1330 IF K=1 THEN D=I-15
1335 IF K=2 THEN D=I-10
1340 IF K=3 THEN D=I-6
1345 IF K=4 THEN D=I+6
1350 IF K=5 THEN D=I+10
1355 IF K=6 THEN D=I+15
1360 IF K=7 THEN D=I+17
1370 IF D<0 THEN 1470
1380 IF D>63 THEN 1470
1390 RR=I/8
1400 RC=I-RR*8
1410 NR=D/8
1420 NC=D-NR*8
1425 DR=NR-RR
1426 DC=NC-RC
1427 IF DR<0 THEN DR=0-DR
1428 IF DC<0 THEN DC=0-DC
1429 IF DR+DC<>3 THEN 1470
1430 IF B[D]>10 THEN 1470
1440 M[MC]=I
1450 MC=MC+1
1460 M[MC]=D
1465 MC=MC+1
1470 K=K+1
1480 IF K<8 THEN 1320
1490 GOTO 1850
1500 REM Rook/Bishop/Queen - just pick simple moves
1510 D=I+1
1520 IF D>63 THEN 1850
1530 RR=I/8
1540 NR=D/8
1545 IF RR<>NR THEN 1850
1550 IF B[D]=0 THEN 1620
1560 IF B[D]<11 THEN 1620
1570 D=I-1
1580 IF D<0 THEN 1850
1590 IF B[D]=0 THEN 1620
1600 IF B[D]>10 THEN 1850
1620 M[MC]=I
1630 MC=MC+1
1640 M[MC]=D
1650 MC=MC+1
1660 GOTO 1850
1700 REM King - try 8 directions
1710 K=0
1720 DR=0-1
1725 DC=0
1730 IF K=1 THEN DR=1
1732 IF K=1 THEN DC=0
1735 IF K=2 THEN DR=0
1737 IF K=2 THEN DC=0-1
1740 IF K=3 THEN DR=0
1742 IF K=3 THEN DC=1
1745 IF K=4 THEN DR=0-1
1747 IF K=4 THEN DC=0-1
1750 IF K=5 THEN DR=0-1
1752 IF K=5 THEN DC=1
1755 IF K=6 THEN DR=1
1757 IF K=6 THEN DC=0-1
1760 IF K=7 THEN DR=1
1762 IF K=7 THEN DC=1
1770 RR=I/8
1780 RC=I-RR*8
1790 NR=RR+DR
1800 NC=RC+DC
1810 IF NR<0 THEN 1840
1815 IF NR>7 THEN 1840
1820 IF NC<0 THEN 1840
1825 IF NC>7 THEN 1840
1830 D=NR*8+NC
1832 IF B[D]<11 THEN 1620
1840 K=K+1
1842 IF K<8 THEN 1720
1850 I=I+1
1860 IF I<64 THEN 1030
1870 REM Pick move
1880 IF MC<2 THEN 9000
1890 F=M[0]
1900 D=M[1]
1910 P=B[F]
1920 PRINT "Computer: ";F;" to ";D
1930 B[D]=P
1940 B[F]=0
1950 T=1
1960 GOTO 380
9000 PRINT "No moves - Game Over"
9010 END