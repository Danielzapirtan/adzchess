10 REM Simple Chess for Minimal BASIC (No GOSUB)
20 REM Board: B[0-63], Pieces: 0=empty, 1-6=W pieces, 11-16=B pieces
30 REM 1/11=Pawn, 2/12=Knight, 3/13=Bishop, 4/14=Rook, 5/15=Queen, 6/16=King
40 DIM B[64]
50 DIM M[400]
60 REM Setup board
70 LET B[0]=14
80 LET B[1]=12
90 LET B[2]=13
100 LET B[3]=15
110 LET B[4]=16
120 LET B[5]=13
130 LET B[6]=12
140 LET B[7]=14
150 LET I=8
160 LET B[I]=11
170 LET I=I+1
180 IF I<16 THEN 160
190 LET I=16
200 LET B[I]=0
210 LET I=I+1
220 IF I<48 THEN 200
230 LET I=48
240 LET B[I]=1
250 LET I=I+1
260 IF I<56 THEN 240
270 LET B[56]=4
280 LET B[57]=2
290 LET B[58]=3
300 LET B[59]=5
310 LET B[60]=6
320 LET B[61]=3
330 LET B[62]=2
340 LET B[63]=4
350 LET T=1
360 PRINT "BASIC Chess Engine"
370 PRINT " "
380 REM Display board
390 PRINT "  0 1 2 3 4 5 6 7"
400 LET R=0
410 PRINT R;": ";
420 LET C=0
430 LET SQ=R*8+C
440 LET P=B[SQ]
450 IF P<>0 THEN 460
455 GOTO 620
460 IF P<>1 THEN 470
465 PRINT "P ";
466 GOTO 580
470 IF P<>2 THEN 480
475 PRINT "N ";
476 GOTO 580
480 IF P<>3 THEN 490
485 PRINT "B ";
486 GOTO 580
490 IF P<>4 THEN 500
495 PRINT "R ";
496 GOTO 580
500 IF P<>5 THEN 510
505 PRINT "Q ";
506 GOTO 580
510 IF P<>6 THEN 520
515 PRINT "K ";
516 GOTO 580
520 IF P<>11 THEN 530
525 PRINT "p ";
526 GOTO 580
530 IF P<>12 THEN 540
535 PRINT "n ";
536 GOTO 580
540 IF P<>13 THEN 550
545 PRINT "b ";
546 GOTO 580
550 IF P<>14 THEN 560
555 PRINT "r ";
556 GOTO 580
560 IF P<>15 THEN 570
565 PRINT "q ";
566 GOTO 580
570 IF P<>16 THEN 580
575 PRINT "k ";
580 LET C=C+1
590 IF C<8 THEN 430
600 PRINT " "
610 GOTO 630
620 PRINT ". ";
625 GOTO 580
630 LET R=R+1
640 IF R<8 THEN 410
650 PRINT " "
660 REM Game turn
670 IF T<>1 THEN 680
675 GOTO 710
680 PRINT "Black (Computer) move"
690 GOTO 1000
710 PRINT "White (Human) move"
720 PRINT "From square (0-63):"
730 INPUT F
740 PRINT "To square (0-63):"
750 INPUT D
760 LET P=B[F]
770 IF P<>0 THEN 780
775 GOTO 720
780 IF P<=10 THEN 800
790 GOTO 720
800 REM Make move
810 LET B[D]=P
820 LET B[F]=0
830 LET T=0
840 GOTO 380
1000 REM Computer finds move
1010 LET MC=0
1020 LET I=0
1030 LET P=B[I]
1040 IF P>=11 THEN 1050
1045 GOTO 1850
1050 IF P<=16 THEN 1070
1060 GOTO 1850
1070 REM Check piece type and generate moves
1080 IF P<>11 THEN 1090
1085 GOTO 1100
1090 IF P<>12 THEN 1095
1092 GOTO 1300
1095 IF P<>13 THEN 1097
1096 GOTO 1500
1097 IF P<>14 THEN 1098
1097 GOTO 1500
1098 IF P<>15 THEN 1099
1098 GOTO 1500
1099 IF P<>16 THEN 1850
1100 GOTO 1700
1110 REM Black Pawn at I
1120 LET D=I+8
1130 IF D<=63 THEN 1140
1135 GOTO 1850
1140 IF B[D]<>0 THEN 1150
1145 GOTO 1260
1150 LET D=I+7
1160 IF D<=63 THEN 1170
1165 GOTO 1850
1170 IF B[D]<>0 THEN 1180
1175 GOTO 1850
1180 IF B[D]<=10 THEN 1190
1185 GOTO 1850
1190 LET M[MC]=I
1200 LET MC=MC+1
1210 LET M[MC]=D
1220 LET MC=MC+1
1230 GOTO 1850
1260 LET M[MC]=I
1270 LET MC=MC+1
1280 LET M[MC]=D
1290 LET MC=MC+1
1295 GOTO 1150
1300 REM Knight at I - try all 8 moves
1310 LET K=0
1320 LET D=I-17
1330 IF K<>1 THEN 1335
1332 LET D=I-15
1335 IF K<>2 THEN 1340
1337 LET D=I-10
1340 IF K<>3 THEN 1345
1342 LET D=I-6
1345 IF K<>4 THEN 1350
1347 LET D=I+6
1350 IF K<>5 THEN 1355
1352 LET D=I+10
1355 IF K<>6 THEN 1360
1357 LET D=I+15
1360 IF K<>7 THEN 1370
1362 LET D=I+17
1370 IF D>=0 THEN 1375
1372 GOTO 1470
1375 IF D<=63 THEN 1380
1377 GOTO 1470
1380 LET RR=I/8
1390 LET RC=I-RR*8
1400 LET NR=D/8
1410 LET NC=D-NR*8
1420 LET DR=NR-RR
1425 LET DC=NC-RC
1430 IF DR>=0 THEN 1435
1432 LET DR=0-DR
1435 IF DC>=0 THEN 1440
1437 LET DC=0-DC
1440 IF DR+DC<>3 THEN 1445
1442 GOTO 1450
1445 GOTO 1470
1450 IF B[D]<=10 THEN 1455
1452 GOTO 1470
1455 LET M[MC]=I
1460 LET MC=MC+1
1465 LET M[MC]=D
1467 LET MC=MC+1
1470 LET K=K+1
1480 IF K<8 THEN 1320
1490 GOTO 1850
1500 REM Rook/Bishop/Queen - just pick simple moves
1510 LET D=I+1
1520 IF D<=63 THEN 1525
1522 GOTO 1850
1525 LET RR=I/8
1530 LET NR=D/8
1540 IF RR=NR THEN 1545
1542 GOTO 1850
1545 IF B[D]<>0 THEN 1550
1547 GOTO 1620
1550 IF B[D]>=11 THEN 1555
1552 GOTO 1620
1555 LET D=I-1
1560 IF D>=0 THEN 1565
1562 GOTO 1850
1565 IF B[D]<>0 THEN 1570
1567 GOTO 1620
1570 IF B[D]<=10 THEN 1575
1572 GOTO 1850
1575 GOTO 1620
1620 LET M[MC]=I
1630 LET MC=MC+1
1640 LET M[MC]=D
1650 LET MC=MC+1
1660 GOTO 1850
1700 REM King - try 8 directions
1710 LET K=0
1720 LET DR=0-1
1725 LET DC=0
1730 IF K<>1 THEN 1735
1732 LET DR=1
1733 LET DC=0
1735 IF K<>2 THEN 1740
1737 LET DR=0
1738 LET DC=0-1
1740 IF K<>3 THEN 1745
1742 LET DR=0
1743 LET DC=1
1745 IF K<>4 THEN 1750
1747 LET DR=0-1
1748 LET DC=0-1
1750 IF K<>5 THEN 1755
1752 LET DR=0-1
1753 LET DC=1
1755 IF K<>6 THEN 1760
1757 LET DR=1
1758 LET DC=0-1
1760 IF K<>7 THEN 1770
1762 LET DR=1
1763 LET DC=1
1770 LET RR=I/8
1780 LET RC=I-RR*8
1790 LET NR=RR+DR
1800 LET NC=RC+DC
1810 IF NR>=0 THEN 1815
1812 GOTO 1840
1815 IF NR<=7 THEN 1820
1817 GOTO 1840
1820 IF NC>=0 THEN 1825
1822 GOTO 1840
1825 IF NC<=7 THEN 1830
1827 GOTO 1840
1830 LET D=NR*8+NC
1832 IF B[D]>=11 THEN 1835
1833 GOTO 1620
1835 GOTO 1840
1840 LET K=K+1
1842 IF K<8 THEN 1720
1845 GOTO 1850
1850 LET I=I+1
1860 IF I<64 THEN 1030
1870 REM Pick move
1880 IF MC>=2 THEN 1885
1882 GOTO 9000
1885 LET F=M[0]
1890 LET D=M[1]
1900 LET P=B[F]
1910 PRINT "Computer: ";F;" to ";D
1920 LET B[D]=P
1930 LET B[F]=0
1940 LET T=1
1950 GOTO 380
9000 PRINT "No moves - Game Over"
9010 END
